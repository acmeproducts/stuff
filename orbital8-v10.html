<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <title>OneDrive Browser</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://alcdn.msauth.net/browser/2.28.1/js/msal-browser.min.js"></script>
  <style>
    html, body { margin: 0; font-family: sans-serif; height: 100%; overflow: hidden; }
    #breadcrumbs, #statusContainer { padding: 10px; }
    #statusToggle { cursor: pointer; }
    #status { display: none; white-space: pre-wrap; max-height: 100px; overflow-y: auto; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #ccc; padding: 6px; }
    th { background: #eee; cursor: pointer; }
    tr:hover { background: #f8f8f8; }#modal {
  position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
  background: rgba(0,0,0,0.92); display: none; flex-direction: column;
  z-index: 10000;
}
#modalHeader {
  display: flex; justify-content: space-between; align-items: center;
  padding: 10px; background: #222; color: white;
}
#modalContent {
  display: flex; flex-direction: column; flex: 1; overflow: hidden;
}
#imageWrapper {
  flex: 1; display: flex; justify-content: center; align-items: center;
  background: #000; overflow: auto;
}
#modalImage {
  max-width: 100%; max-height: 100%;
  transition: transform 0.2s ease;
}
#controls {
  background: #111; color: white; padding: 10px; display: flex;
  justify-content: center; gap: 12px;
}
#metadata {
  max-height: 30vh; background: white; overflow-y: auto;
  border-top: 1px solid #ccc;
}
#metadata h3 {
  margin: 0; padding: 8px; background: #333; color: white;
  cursor: pointer;
}
#metadataTable {
  width: 100%; border-collapse: collapse;
}
#metadataTable th, #metadataTable td {
  border: 1px solid #ccc;
  padding: 6px;
  word-break: break-word;
}
.copy-btn {
  background: none;
  border: none;
  cursor: pointer;
}
#zoomSlider {
  position: absolute;
  left: 10px;
  top: 60px;
  z-index: 10001;
}

  </style>
</head>
<body>
  <h2 style="margin: 10px;">OneDrive Browser</h2>
  <button id="signInBtn" style="margin-left: 10px;">Sign In</button>
  <div id="statusContainer">
    <span id="statusToggle">▶ Debug</span>
    <div id="status">Status: Ready</div>
  </div>
  <div id="breadcrumbs"></div>
  <table>
    <thead>
      <tr>
        <th onclick="sortTable(0)">Name</th>
        <th onclick="sortTable(1)">Size (MB)</th>
        <th onclick="sortTable(2)">Created</th>
        <th onclick="sortTable(3)">Modified</th>
      </tr>
    </thead>
    <tbody id="gridBody"></tbody>
  </table>  <div id="modal">
    <div id="modalHeader">
      <div>Image Viewer</div>
      <button onclick="closeModal()" style="background:none;border:none;font-size:24px;color:white;">✕</button>
    </div>
    <div id="controls">
      <button onclick="prevImage()">Prev</button>
      <button onclick="nextImage()">Next</button>
      <button onclick="deleteImage()">Delete</button>
    </div>
    <input id="zoomSlider" type="range" min="10" max="200" value="100">
    <div id="modalContent">
      <div id="imageWrapper"><img id="modalImage"></div>
      <div id="metadata">
        <h
